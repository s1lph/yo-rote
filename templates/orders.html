{% extends "base.html" %}
{% set show_menu = True %}

{% block title %}–ó–∞–∫–∞–∑—ã - yo.route{% endblock %}

{% block content %}
<!-- –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–∫–∞–∑–æ–≤ -->
<div class="two-column" id="orders-container" style="max-width: 100%;">
    <div class="column" id="orders-list-page" style="padding-bottom: 80px;">
        <div class="page-header"
            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <div style="display: flex; align-items: center; gap: 12px;">
                <h1 class="page-title"><i class="fi fi-sr-clipboard-list" style="color: var(--primary-blue);"></i>
                    –ó–∞–∫–∞–∑—ã</h1>
            </div>
            <div style="display: flex; gap: 12px; align-items: center;">
                <div style="position: relative; width: 300px;">
                    <input type="text" id="search-orders" class="form-input" placeholder="–ü–æ–∏—Å–∫"
                        style="padding-left: 40px;">
                    <span
                        style="position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: var(--text-gray);">üîç</span>
                </div>
                <button class="btn btn-secondary" id="import-excel-btn"><i class="fi fi-sr-file-excel"></i> –ò–º–ø–æ—Ä—Ç
                    Excel</button>
                <button class="btn btn-primary" id="add-order-btn"><i class="fi fi-sr-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑</button>
            </div>
        </div>

        <div class="table-container">
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 40px;"></th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</th>
                        <th>–ê–¥—Ä–µ—Å –ø–æ–ª—É—á–∞—Ç–µ–ª—è</th>
                        <th>–î–∞—Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∏</th>
                        <th>–í—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–ö—É—Ä—å–µ—Ä</th>
                        <th>–ö–æ–º–ø–∞–Ω–∏—è</th>
                        <th>–ü–æ–ª—É—á–∞—Ç–µ–ª—å</th>
                        <th>–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—è</th>
                    </tr>
                </thead>
                <tbody id="orders-table-body">
                    <tr data-order-row>
                        <td><input type="radio" name="selected_order" value="1" data-order-name="–ó–∞–∫–∞–∑ TEST-1001"></td>
                        <td><strong>–ó–∞–∫–∞–∑ TEST-1001</strong></td>
                        <td>–ú–æ—Å–∫–≤–∞ —É–ª. –ü—É—à–∫–∏–Ω–∞ 67</td>
                        <td>29.09.2025</td>
                        <td>15.00-19.00</td>
                        <td><span class="status-badge status-planned">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω</span></td>
                        <td>–ê–∑—ã–º–±–µ–∫ –ö–∞–∑–±–µ–∫</td>
                        <td>AlexusPrime</td>
                        <td>–ê–ª–µ–∫—Å–µ–π –ù.</td>
                        <td>+79995553534</td>
                    </tr>
                    <tr data-order-row>
                        <td><input type="radio" name="selected_order" value="2" data-order-name="–ó–∞–∫–∞–∑ TEST-1002"></td>
                        <td><strong>–ó–∞–∫–∞–∑ TEST-1002</strong></td>
                        <td>–ú–æ—Å–∫–≤–∞ —É–ª. –õ–µ–Ω–∏–Ω–∞ 12</td>
                        <td>30.09.2025</td>
                        <td>10.00-14.00</td>
                        <td><span class="status-badge status-completed">–ó–∞–≤–µ—Ä—à–µ–Ω</span></td>
                        <td>–ê–∑–∞–º–∞—Ç –ê–π—Ç–∞–ª–∏–µ–≤</td>
                        <td>TechCorp</td>
                        <td>–ò–≤–∞–Ω –ü.</td>
                        <td>+79991234567</td>
                    </tr>
                    <tr data-order-row>
                        <td><input type="radio" name="selected_order" value="3" data-order-name="–ó–∞–∫–∞–∑ TEST-1003"></td>
                        <td><strong>–ó–∞–∫–∞–∑ TEST-1003</strong></td>
                        <td>–ú–æ—Å–∫–≤–∞ –ø—Ä. –ú–∏—Ä–∞ 45</td>
                        <td>01.10.2025</td>
                        <td>12.00-16.00</td>
                        <td><span class="status-badge status-in-progress">–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è</span></td>
                        <td>–ú–∏—Ö–∞–∏–ª –©–µ—Ä–±–µ—Ç–æ–≤</td>
                        <td>DeliveryPro</td>
                        <td>–ú–∞—Ä–∏—è –°.</td>
                        <td>+79997654321</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞ (—Å–∫—Ä—ã—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–ø—Ä–∞–≤–∞) -->
    <div class="column" id="create-order-column" style="display: none; opacity: 0;">
        <div class="page-header">
            <button class="back-button" id="close-create-order-btn">‚Üê</button>
            <h2 class="page-title" style="font-size: 20px;">–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
        </div>

        <form action="/api/orders" method="POST" id="create-order-form">
            <div class="form-group">
                <label class="form-label" for="order_name">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞</label>
                <input type="text" id="order_name" name="order_name" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="destination_point">–ü—É–Ω–∫—Ç –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</label>
                <input type="text" id="destination_point" name="destination_point" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="point_id">–¢–æ—á–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è</label>
                <div id="point-selector">
                    <select id="point_id" name="point_id" class="form-select" required>
                        <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ—á–µ–∫...</option>
                    </select>
                    <button type="button" class="btn btn-secondary btn-small" id="manage-points-link"
                        style="margin-top: 8px;">
                        + –°–æ–∑–¥–∞—Ç—å —Ç–æ—á–∫—É –≤–æ –≤–∫–ª–∞–¥–∫–µ ¬´–¢–æ—á–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏¬ª
                    </button>
                </div>
                <small style="display:block; color:var(--text-gray); margin-top:4px;">
                    –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–∫–∞–º–∏ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ –≤–æ –≤–∫–ª–∞–¥–∫–µ ¬´–¢–æ—á–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏¬ª
                </small>
            </div>

            <div class="form-group">
                <label class="form-label" for="visit_date">–î–∞—Ç–∞ –ø–æ—Å–µ—â–µ–Ω–∏—è —Ç–æ—á–∫–∏</label>
                <input type="date" id="visit_date" name="visit_date" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="visit_time">–í—Ä–µ–º—è –ø–æ—Å–µ—â–µ–Ω–∏—è —Ç–æ—á–∫–∏</label>
                <input type="time" id="visit_time" name="visit_time" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="time_at_point">–í—Ä–µ–º—è –Ω–∞ –ø–æ—Å–µ—â–µ–Ω–∏–µ —Ç–æ—á–∫–∏</label>
                <input type="number" id="time_at_point" name="time_at_point" class="form-input" placeholder="–º–∏–Ω—É—Ç—ã"
                    required>
            </div>

            <div class="form-group">
                <label class="form-label" for="recipient_name">–§–ò–û</label>
                <input type="text" id="recipient_name" name="recipient_name" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="recipient_phone">–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label>
                <input type="tel" id="recipient_phone" name="recipient_phone" class="form-input" required>
            </div>

            <div class="form-group">
                <label class="form-label" for="courier_id">–ó–∞–∫—Ä–µ–ø–∏—Ç—å –∫—É—Ä—å–µ—Ä–∞</label>
                <select id="courier_id" name="courier_id" class="form-select" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—å–µ—Ä–∞</option>
                </select>
                <small style="display:block; margin-top:4px; color:var(--text-gray); font-size:12px;">
                    –ö—É—Ä—å–µ—Ä –ø–æ–ª—É—á–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
                </small>
            </div>

            <div class="form-group">
                <label class="form-label" for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–¥–ª—è –∫—É—Ä—å–µ—Ä–∞)</label>
                <textarea id="comment" name="comment" class="form-textarea" rows="3"></textarea>
            </div>

            <button type="submit" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å</button>
        </form>

        <div class="map-container" style="margin-top: 24px; min-height: 400px;">
            <div>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–Ω–∫—Ç–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</div>
        </div>
    </div>
</div>
<!-- –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ -->
<div id="selected-orders-panel" class="selection-panel">
    <div class="selection-panel-content">
        <span id="selected-count" class="selection-panel-text">–í—ã–±—Ä–∞–Ω 1 –∑–∞–∫–∞–∑</span>
        <button id="clear-selection" class="selection-panel-close">
            <i class="fi fi-sr-cross-small"></i>
        </button>
    </div>
    <div class="selection-panel-actions">
        <button class="btn btn-secondary" id="delete-orders-btn">
            <i class="fi fi-sr-trash"></i> –£–¥–∞–ª–∏—Ç—å
        </button>
        <button class="btn btn-secondary" id="change-status-btn">
            <i class="fi fi-sr-menu-dots-vertical"></i> –°—Ç–∞—Ç—É—Å
        </button>
        <button class="btn btn-secondary" id="edit-order-btn">
            <i class="fi fi-sr-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å
        </button>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', async function () {
        const ordersContainer = document.getElementById('orders-container');
        const createOrderColumn = document.getElementById('create-order-column');
        const addOrderButtons = document.querySelectorAll('#add-order-btn');
        const closeCreateOrderBtn = document.getElementById('close-create-order-btn');
        const selectedOrdersPanel = document.getElementById('selected-orders-panel');
        const selectedCount = document.getElementById('selected-count');
        const clearSelection = document.getElementById('clear-selection');
        const deleteOrdersBtn = document.getElementById('delete-orders-btn');
        const changeStatusBtn = document.getElementById('change-status-btn');
        const editOrderBtn = document.getElementById('edit-order-btn');
        const createOrderForm = document.getElementById('create-order-form');
        const ordersTableBody = document.getElementById('orders-table-body');
        const searchInput = document.getElementById('search-orders');

        const courierSelect = document.getElementById('courier_id');
        const pointSelect = document.getElementById('point_id');
        const managePointsLink = document.getElementById('manage-points-link');

        try {
            const response = await api.get('/api/orders');
            const loadedOrders = (response.orders || []).length ? response.orders : getSampleOrders();
            updateOrdersTable(loadedOrders);
        } catch (error) {
            console.error('Error loading orders:', error);
            updateOrdersTable(getSampleOrders());
        }

        await Promise.all([loadCouriers(), loadPoints()]);

        async function loadCouriers() {
            if (!courierSelect) return;
            try {
                const { couriers = [] } = await api.get('/api/couriers');
                if (couriers.length === 0) {
                    courierSelect.innerHTML = '<option value="">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫—É—Ä—å–µ—Ä–æ–≤</option>';
                    courierSelect.disabled = true;
                    return;
                }
                courierSelect.disabled = false;
                courierSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—å–µ—Ä–∞</option>' +
                    couriers.map(courier => `<option value="${courier.id}">${courier.full_name}</option>`).join('');
            } catch (error) {
                console.error('Error loading couriers:', error);
                courierSelect.innerHTML = '<option value="">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫—É—Ä—å–µ—Ä–æ–≤</option>';
                courierSelect.disabled = true;
            }
        }

        async function loadPoints() {
            if (!pointSelect) return;
            try {
                let { points = [] } = await api.get('/api/points');
                if (!points.length) {
                    points = getSamplePoints();
                }
                pointSelect.disabled = false;
                pointSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ—á–∫—É</option>' +
                    points.map(point => {
                        const prefix = point.is_primary ? '‚òÖ ' : '';
                        return `<option value="${point.id}">${prefix}${point.address}</option>`;
                    }).join('');
            } catch (error) {
                console.error('Error loading points:', error);
                pointSelect.innerHTML = '<option value="">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ—á–∫–∏</option>';
                pointSelect.disabled = true;
            }
        }

        managePointsLink?.addEventListener('click', () => {
            window.location.href = '/points#add-point';
        });

        function openCreateOrderForm() {
            createOrderColumn.style.display = 'block';
            ordersContainer.classList.add('show-add-form');
            setTimeout(() => {
                createOrderColumn.style.opacity = '1';
            }, 10);
        }

        addOrderButtons.forEach(button => {
            button.addEventListener('click', function () {
                openCreateOrderForm();
            });
        });

        if (window.location.hash === '#add-order') {
            openCreateOrderForm();
        }
        window.addEventListener('hashchange', () => {
            if (window.location.hash === '#add-order') {
                openCreateOrderForm();
            }
        });

        closeCreateOrderBtn.addEventListener('click', function () {
            closeCreateOrderForm();
        });

        function closeCreateOrderForm() {
            createOrderColumn.style.opacity = '0';
            setTimeout(() => {
                createOrderColumn.style.display = 'none';
                ordersContainer.classList.remove('show-add-form');
                createOrderForm.reset();
                if (window.location.hash === '#add-order') {
                    history.replaceState(null, '', window.location.pathname);
                }
            }, 300);
        }

        function updateSelectedPanel() {
            const selected = document.querySelectorAll('input[name="selected_order"]:checked');
            if (selected.length > 0) {
                const preview = selected[0].getAttribute('data-order-name');
                const extra = selected.length > 1 ? ` –∏ –µ—â–µ ${selected.length - 1}` : '';
                selectedCount.textContent = `–í—ã–±—Ä–∞–Ω–æ ${selected.length}: ${preview}${extra}`;
                selectedOrdersPanel.classList.add('active');
                // selectedOrdersPanel.style.display = 'block'; // Removed inline style manipulation
            } else {
                selectedOrdersPanel.classList.remove('active');
                // setTimeout(() => { selectedOrdersPanel.style.display = 'none'; }, 300); // Handled by CSS opacity
            }
        }

        function updateRadioButtons() {
            const newRadioButtons = document.querySelectorAll('input[name="selected_order"]');
            newRadioButtons.forEach(radio => {
                radio.addEventListener('change', function () {
                    updateSelectedPanel();
                });
            });
        }

        clearSelection.addEventListener('click', function () {
            document.querySelectorAll('input[name="selected_order"]').forEach(radio => radio.checked = false);
            updateSelectedPanel();
        });

        deleteOrdersBtn.addEventListener('click', async function () {
            const selected = Array.from(document.querySelectorAll('input[name="selected_order"]:checked'))
                .map(radio => radio.value);

            if (selected.length === 0) return;

            if (confirm(`–£–¥–∞–ª–∏—Ç—å ${selected.length} ${selected.length === 1 ? '–∑–∞–∫–∞–∑' : '–∑–∞–∫–∞–∑–æ–≤'}?`)) {
                try {
                    const response = await fetch('/api/orders/batch', {
                        method: 'DELETE',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ ids: selected })
                    });

                    const result = await response.json();

                    if (result.success) {
                        for (const id of selected) {
                            const row = document.querySelector(`input[value="${id}"]`)?.closest('tr');
                            if (row) row.remove();
                        }
                        showNotification('–ó–∞–∫–∞–∑—ã —É–¥–∞–ª–µ–Ω—ã', 'success');
                        updateSelectedPanel();
                        updateRadioButtons();
                    } else {
                        showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏', 'error');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
                }
            }
        });

        changeStatusBtn.addEventListener('click', function () {
            alert('–í—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ (–±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)');
        });

        editOrderBtn.addEventListener('click', function () {
            const selected = document.querySelector('input[name="selected_order"]:checked');
            if (!selected) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–∫–∞–∑ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'info');
                return;
            }

            // Open the create/edit form
            openCreateOrderForm();
            showNotification('–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ (–±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)', 'info');
        });

        createOrderForm.addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const data = Object.fromEntries(formData);

            try {
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (result.success) {
                    showNotification('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω', 'success');
                    const redirectToOptimization = () => {
                        const orderId = result.id || '';
                        if (orderId) {
                            window.location.href = `/optimization#order=${orderId}`;
                        } else {
                            window.location.href = '/optimization';
                        }
                    };
                    setTimeout(() => {
                        closeCreateOrderForm();
                        redirectToOptimization();
                    }, 600);
                    updateRadioButtons();
                } else {
                    showNotification(result.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–∫–∞–∑–∞', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º', 'error');
            }
        });

        searchInput.addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase();
            const rows = document.querySelectorAll('#orders-table-body tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        updateSelectedPanel();

        function updateOrdersTable(orders = []) {
            if (!ordersTableBody) return;
            if (!orders.length) {
                ordersTableBody.innerHTML = `
                    <tr>
                        <td colspan="10" style="text-align:center; padding:24px; color: var(--text-gray);">
                            –ó–∞–∫–∞–∑—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
                        </td>
                    </tr>
                `;
                updateRadioButtons();
                updateSelectedPanel();
                return;
            }
            ordersTableBody.innerHTML = orders.map(order => {
                const orderId = order.id || `temp-${Math.random().toString(36).slice(2)}`;
                const orderName = order.order_name || `–ó–∞–∫–∞–∑ #${orderId}`;
                const address = order.destination_point || order.point_address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω';
                const visitDate = order.visit_date || '‚Äî';
                const visitTime = order.visit_time || '‚Äî';
                const courierName = order.courier_name || '–ö—É—Ä—å–µ—Ä –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω';
                const company = order.company || '‚Äî';
                const recipient = order.recipient_name || '‚Äî';
                const recipientPhone = order.recipient_phone || '‚Äî';
                const statusBadge = getStatusBadge(order.status);

                return `
                    <tr data-order-row>
                        <td><input type="radio" name="selected_order" value="${orderId}" data-order-name="${orderName}"></td>
                        <td><strong>${orderName}</strong></td>
                        <td>${address}</td>
                        <td>${visitDate}</td>
                        <td>${visitTime}</td>
                        <td>${statusBadge}</td>
                        <td>${courierName}</td>
                        <td>${company}</td>
                        <td>${recipient}</td>
                        <td>${recipientPhone}</td>
                    </tr>
                `;
            }).join('');

            updateRadioButtons();
            updateSelectedPanel();
        }

        function getStatusBadge(status = 'planned') {
            const dictionary = {
                planned: { text: '–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω', className: 'status-planned' },
                in_progress: { text: '–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è', className: 'status-in-progress' },
                completed: { text: '–ó–∞–≤–µ—Ä—à–µ–Ω', className: 'status-completed' }
            };
            const { text, className } = dictionary[status] || dictionary.planned;
            return `<span class="status-badge ${className}">${text}</span>`;
        }

        function getSampleOrders() {
            return [
                {
                    id: 1001,
                    order_name: '–ó–∞–∫–∞–∑ TEST-1001',
                    destination_point: '–ú–æ—Å–∫–≤–∞ —É–ª. –ü—É—à–∫–∏–Ω–∞ 67',
                    visit_date: '2025-09-29',
                    visit_time: '15:00-19:00',
                    status: 'planned',
                    courier_name: '–ê–∑—ã–º–±–µ–∫ –ö–∞–∑–±–µ–∫',
                    company: 'AlexusPrime',
                    recipient_name: '–ê–ª–µ–∫—Å–µ–π –ù.',
                    recipient_phone: '+79995553534'
                },
                {
                    id: 1002,
                    order_name: '–ó–∞–∫–∞–∑ TEST-1002',
                    destination_point: '–ú–æ—Å–∫–≤–∞ —É–ª. –õ–µ–Ω–∏–Ω–∞ 12',
                    visit_date: '2025-09-30',
                    visit_time: '10:00-14:00',
                    status: 'completed',
                    courier_name: '–ê–∑–∞–º–∞—Ç –ê–π—Ç–∞–ª–∏–µ–≤',
                    company: 'TechCorp',
                    recipient_name: '–ò–≤–∞–Ω –ü.',
                    recipient_phone: '+79991234567'
                },
                {
                    id: 1003,
                    order_name: '–ó–∞–∫–∞–∑ TEST-1003',
                    destination_point: '–ú–æ—Å–∫–≤–∞ –ø—Ä. –ú–∏—Ä–∞ 45',
                    visit_date: '2025-10-01',
                    visit_time: '12:00-16:00',
                    status: 'in_progress',
                    courier_name: '–ú–∏—Ö–∞–∏–ª –©–µ—Ä–±–µ—Ç–æ–≤',
                    company: 'DeliveryPro',
                    recipient_name: '–ú–∞—Ä–∏—è –°.',
                    recipient_phone: '+79997654321'
                }
            ];
        }

        function getSamplePoints() {
            return [
                { id: 1, address: '–ú–æ—Å–∫–≤–∞, —É–ª. –û—Ä—à–∞–Ω—Å–∫–∞—è 13', is_primary: true },
                { id: 2, address: '–•–∏–º–∫–∏, —É–ª. –ì–µ—Ä–º–∞–Ω–∞ –¢–∏—Ç–æ–≤–∞ 3', is_primary: false }
            ];
        }
    });
</script>
{% endblock %}